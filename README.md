The final version of the code
